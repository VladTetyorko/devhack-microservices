<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/layout :: layout(${pageTitle}, ~{::section})}">
<body>
<section>
    <!-- Welcome Banner -->
    <div class="card bg-primary text-white mb-4">
        <div class="card-body p-4">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h2 class="display-5 fw-bold">Study Dashboard</h2>
                    <p class="lead">Track your interview preparation progress</p>
                </div>
                <div class="col-md-4 text-md-end mt-3 mt-md-0">
                    <a th:href="@{/questions}" class="btn btn-light btn-lg">
                        <i class="fas fa-list me-2"></i>View Questions
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Progress Overview -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-light">
                    <h4 class="mb-0"><i class="fas fa-chart-line me-2"></i>Your Progress</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3 col-sm-6 mb-3">
                            <div class="card border-0 bg-light h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-question-circle fa-3x text-primary mb-3"></i>
                                    <h5>Questions</h5>
                                    <h2 class="display-6" th:text="${questionCount} + '/100'">0/100</h2>
                                    <div class="progress mt-2">
                                        <div class="progress-bar" role="progressbar"
                                             th:style="'width: ' + ${questionProgress} + '%'"
                                             th:aria-valuenow="${questionProgress}" aria-valuemin="0"
                                             aria-valuemax="100"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-3">
                            <div class="card border-0 bg-light h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-comment fa-3x text-success mb-3"></i>
                                    <h5>Answers</h5>
                                    <h2 class="display-6" th:text="${answerCount} + '/100'">0/100</h2>
                                    <div class="progress mt-2">
                                        <div class="progress-bar bg-success" role="progressbar"
                                             th:style="'width: ' + ${answerProgress} + '%'"
                                             th:aria-valuenow="${answerProgress}" aria-valuemin="0"
                                             aria-valuemax="100"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-3">
                            <div class="card border-0 bg-light h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-sticky-note fa-3x text-warning mb-3"></i>
                                    <h5>Notes</h5>
                                    <h2 class="display-6" th:text="${noteCount} + '/100'">0/100</h2>
                                    <div class="progress mt-2">
                                        <div class="progress-bar bg-warning" role="progressbar"
                                             th:style="'width: ' + ${noteProgress} + '%'"
                                             th:aria-valuenow="${noteProgress}" aria-valuemin="0"
                                             aria-valuemax="100"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-3">
                            <div class="card border-0 bg-light h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-tags fa-3x text-info mb-3"></i>
                                    <h5>Topics Covered</h5>
                                    <h2 class="display-6" th:text="${tagCount} + '/20'">0/20</h2>
                                    <div class="progress mt-2">
                                        <div class="progress-bar bg-info" role="progressbar"
                                             th:style="'width: ' + ${tagProgress} + '%'"
                                             th:aria-valuenow="${tagProgress}" aria-valuemin="0"
                                             aria-valuemax="100"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Detailed Progress Tracking -->
    <div class="row mb-4">
        <div class="col-md-6 mb-3">
            <div class="card h-100">
                <div class="card-header bg-light">
                    <h4 class="mb-0"><i class="fas fa-signal me-2"></i>Progress by Difficulty</h4>
                </div>
                <div class="card-body">
                    <!-- Easy Questions -->
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-1">
                            <div>
                                <i class="fas fa-circle text-success me-2"></i>
                                <span>Easy Questions</span>
                            </div>
                            <div>
                                <span class="badge bg-success"
                                      th:text="${easyAnswerCount} + '/' + ${easyQuestionCount}">0/0</span>
                            </div>
                        </div>
                        <div class="progress" style="height: 10px;">
                            <div class="progress-bar bg-success" role="progressbar"
                                 th:style="'width: ' + ${easyAnswerPercentage} + '%'"
                                 th:aria-valuenow="${easyAnswerPercentage}" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <div class="text-end mt-1">
                            <small class="text-muted" th:text="${easyAnswerPercentage} + '% completed'">0%
                                completed</small>
                        </div>
                    </div>

                    <!-- Medium Questions -->
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-1">
                            <div>
                                <i class="fas fa-circle text-warning me-2"></i>
                                <span>Medium Questions</span>
                            </div>
                            <div>
                                <span class="badge bg-warning"
                                      th:text="${mediumAnswerCount} + '/' + ${mediumQuestionCount}">0/0</span>
                            </div>
                        </div>
                        <div class="progress" style="height: 10px;">
                            <div class="progress-bar bg-warning" role="progressbar"
                                 th:style="'width: ' + ${mediumAnswerPercentage} + '%'"
                                 th:aria-valuenow="${mediumAnswerPercentage}" aria-valuemin="0"
                                 aria-valuemax="100"></div>
                        </div>
                        <div class="text-end mt-1">
                            <small class="text-muted" th:text="${mediumAnswerPercentage} + '% completed'">0%
                                completed</small>
                        </div>
                    </div>

                    <!-- Hard Questions -->
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-1">
                            <div>
                                <i class="fas fa-circle text-danger me-2"></i>
                                <span>Hard Questions</span>
                            </div>
                            <div>
                                <span class="badge bg-danger" th:text="${hardAnswerCount} + '/' + ${hardQuestionCount}">0/0</span>
                            </div>
                        </div>
                        <div class="progress" style="height: 10px;">
                            <div class="progress-bar bg-danger" role="progressbar"
                                 th:style="'width: ' + ${hardAnswerPercentage} + '%'"
                                 th:aria-valuenow="${hardAnswerPercentage}" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <div class="text-end mt-1">
                            <small class="text-muted" th:text="${hardAnswerPercentage} + '% completed'">0%
                                completed</small>
                        </div>
                    </div>

                    <div class="text-center mt-4">
                        <a th:href="@{/questions}" class="btn btn-outline-primary">
                            <i class="fas fa-list me-1"></i>View All Questions
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-6 mb-3">
            <div class="card h-100">
                <div class="card-header bg-light">
                    <h4 class="mb-0"><i class="fas fa-tags me-2"></i>Progress by Topic</h4>
                </div>
                <div class="card-body">
                    <div th:if="${not #lists.isEmpty(allTags)}" class="tag-progress">
                        <div th:each="tag : ${allTags}" class="mb-3">
                            <div class="d-flex justify-content-between align-items-center mb-1">
                                <div>
                                    <i class="fas fa-tag text-info me-2"></i>
                                    <span th:text="${tag.name}">Tag Name</span>
                                </div>
                                <div>
                                    <a th:href="@{/questions/tag/{slug}(slug=${tag.slug})}"
                                       class="badge bg-info text-decoration-none">
                                        <i class="fas fa-external-link-alt me-1"></i>View
                                    </a>
                                </div>
                            </div>
                            <div class="progress" style="height: 8px;">
                                <div class="progress-bar bg-info" role="progressbar"
                                     th:style="'width: ' + ${tagProgressPercentages.get(tag.id)} + '%'"
                                     th:aria-valuenow="${tagProgressPercentages.get(tag.id)}"
                                     aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                            <div class="d-flex justify-content-between mt-1">
                                <small class="text-muted"
                                       th:text="${tagAnswerCounts.get(tag.id)} + '/' + ${tagQuestionCounts.get(tag.id)} + ' questions answered'">
                                    0/0 questions answered
                                </small>
                                <small class="text-muted"
                                       th:text="${tagProgressPercentages.get(tag.id)} + '% completed'">
                                    0% completed
                                </small>
                            </div>
                        </div>
                    </div>
                    <div th:if="${#lists.isEmpty(allTags)}" class="text-center py-4">
                        <i class="fas fa-tag fa-3x text-muted mb-3"></i>
                        <p class="text-muted">No tags available yet.</p>
                    </div>

                    <div class="text-center mt-4">
                        <a th:href="@{/tags}" class="btn btn-outline-info">
                            <i class="fas fa-tags me-1"></i>Manage Tags
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-light">
                    <h4 class="mb-0"><i class="fas fa-bolt me-2"></i>Quick Actions</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3 col-sm-6 mb-3">
                            <a th:href="@{/questions}" class="text-decoration-none">
                                <div class="card h-100 border-primary hover-shadow">
                                    <div class="card-body text-center">
                                        <i class="fas fa-question-circle fa-3x text-primary mb-3"></i>
                                        <h5 class="card-title">Practice Questions</h5>
                                    </div>
                                </div>
                            </a>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-3">
                            <a th:href="@{/answers/new}" class="text-decoration-none">
                                <div class="card h-100 border-success hover-shadow">
                                    <div class="card-body text-center">
                                        <i class="fas fa-comment fa-3x text-success mb-3"></i>
                                        <h5 class="card-title">Add Answer</h5>
                                    </div>
                                </div>
                            </a>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-3">
                            <a th:href="@{/notes/new}" class="text-decoration-none">
                                <div class="card h-100 border-warning hover-shadow">
                                    <div class="card-body text-center">
                                        <i class="fas fa-sticky-note fa-3x text-warning mb-3"></i>
                                        <h5 class="card-title">Create Note</h5>
                                    </div>
                                </div>
                            </a>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-3">
                            <a th:href="@{/tags}" class="text-decoration-none">
                                <div class="card h-100 border-info hover-shadow">
                                    <div class="card-body text-center">
                                        <i class="fas fa-tags fa-3x text-info mb-3"></i>
                                        <h5 class="card-title">Browse Topics</h5>
                                    </div>
                                </div>
                            </a>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-3">
                            <a th:href="@{/questions/generate}" class="text-decoration-none">
                                <div class="card h-100 border-secondary hover-shadow">
                                    <div class="card-body text-center">
                                        <i class="fas fa-robot fa-3x text-secondary mb-3"></i>
                                        <h5 class="card-title">Generate Questions with AI</h5>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
</body>
</html>
